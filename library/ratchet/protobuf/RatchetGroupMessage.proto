syntax = "proto2";

message MessageParticipantInfo {
    required uint32 version = 1;
    required bytes id = 2;
    required bytes key = 3;
    required bytes pub_key = 4;
    required uint32 index = 5;
}

message MessageGroupInfo {
    required uint32 version = 1;
    required bytes session_id = 2;
    enum Type {
        START = 1;
        ADD = 2;
        CHANGE = 3;
    }
    required Type type = 3;
    required uint32 epoch = 4;
    repeated MessageParticipantInfo participants = 5;
}

message RegularGroupMessageHeader {
    required uint32 version = 1;
    required uint32 epoch = 2;
    required uint32 prev_epoch_msgs = 3;
    required uint32 counter = 4;
    required bytes sender_id = 5;
    required bytes commitment = 6;
    required bytes signature = 7;
}

message RegularGroupMessage {
    required uint32 version = 1;
    required bytes header = 2;
    required bytes cipher_text = 3;
}

message GroupMessage {
    required uint32 version = 1;
    optional MessageGroupInfo group_info = 2;
    optional RegularGroupMessage regular_message = 3;
}