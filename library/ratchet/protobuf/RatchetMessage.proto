syntax = "proto2";

message RegularMessageHeader {
    required uint32 version = 1;
    required uint32 counter = 2;
    required uint32 prev_chain_count = 3;
    required bytes public_key = 4;
}

message RegularMessage {
    required uint32 version = 1;
    required bytes header = 2;
    required bytes cipher_text = 3;
}

message PrekeyMessage {
    required uint32 version = 1;
    required bytes sender_identity_key = 2;
    required bytes sender_ephemeral_key = 3;
    required bytes receiver_long_term_key = 4;
    optional bytes receiver_one_time_key = 5;
}

message Message {
    required uint32 version = 1;
    required RegularMessage regular_message = 2;
    optional PrekeyMessage prekey_message = 3;
}