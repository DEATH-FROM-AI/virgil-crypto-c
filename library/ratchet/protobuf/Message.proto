syntax = "proto3";
import "nanopb.proto";

message RegularMessage {
	uint32 version = 1;
	uint32 counter = 2;
	bytes public_key = 3 [(nanopb).max_size = 32, (nanopb).fixed_length = true];
	bytes cipher_text = 4 [(nanopb).max_size = 64, (nanopb).fixed_length = true];
}

message PrekeyMessage {
	uint32 version = 1;
	bytes sender_identity_key = 2 [(nanopb).max_size = 32, (nanopb).fixed_length = true];
	bytes sender_ephemeral_key = 3 [(nanopb).max_size = 32, (nanopb).fixed_length = true];
	bytes receiver_long_term_key = 4 [(nanopb).max_size = 32, (nanopb).fixed_length = true];
	bytes receiver_one_time_key = 5 [(nanopb).max_size = 32, (nanopb).fixed_length = true];
	RegularMessage regular_message = 6;
}

message Message {
	oneof message {
		RegularMessage regular_message = 1;
		PrekeyMessage prekey_message = 2;
	}
}