<class name="pythia">
    Provide Pythia implementation based on the Virgil Security.

    <require module="library"/>
    <require module="error"/>

    <property name="instances" type="size"/>


    <method name="blinded password len" context="none">
        Return length of the buffer needed to hold 'blinded password'.
        <return type="size"/>
    </method>


    <method name="deblinded password len" context="none">
        Return length of the buffer needed to hold 'deblinded password'.
        <return type="size"/>
    </method>


    <method name="blinding secret len" context="none">
        Return length of the buffer needed to hold 'blinding secret'.
        <return type="size"/>
    </method>


    <method name="blind">
        Blinds password. Turns password into a pseudo-random string.
        This step is necessary to prevent 3rd-parties from knowledge of end user's password.

        <argument name="password" type="data"/>
        <argument name="pssword len" type="size"/>
        <argument name="blinded password" type="data" access="writeonly"/>
        <argument name="blinded password len" type="size"/>
        <argument name="blinding secret" type="data" access="writeonly"/>
        <argument name="blinding secret len" type="size"/>
    </method>


    <method name="deblind">
        Deblinds 'transformed password' value with previously returned 'blinding secret' from blind().

        <argument name="transformed password" type="data"/>
        <argument name="transformed pssword len" type="size"/>
        <argument name="blinding secret" type="data"/>
        <argument name="blinding secret len" type="size"/>
        <argument name="deblinded password" type="data" access="writeonly"/>
        <argument name="deblinded password len" type="size"/>
    </method>

</class>
