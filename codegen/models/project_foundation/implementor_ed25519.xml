<implementor name="ed25519 pk" is_default="1">
    Provide implementation based on the library ed25519
    <implementation name="ed25519 public key">
      This is implementation of ED25519 public key
      <require library="ed25519" feature="ED25519 C"/>

      <context>
        <require header="ed25519/ed25519.h"/>
        <property name="public_key" type="byte" access="readwrite">
          <array length="fixed" length_constant="ED25519_KEY_LEN"/>
        </property>
        <property name="signature" type="byte" access="readwrite">
          <array length="fixed" length_constant="ED25519_KEY_LEN"/>
        </property>
        <property name="message" class="buffer" type="byte" access="readwrite"/>
        <property name="message_len" type="size" access="readwrite"/>
      </context>

      <interface name="key"/>
      <interface name="public key"/>
      <interface name="encrypt"/>
      <interface name="verify"/>
      <interface name="export public key"/>
      <interface name="import public key"/>

      <method name="curve25519 key exchange" context="impl">
        Compute shared secret based on the Curve25519 montgomery curve
        <argument name="shared key" type="byte" access="readwrite">
          <array length="fixed" length_constant="ED25519_DH_LEN"/>
        </argument>
        <argument name="public key" type="byte" access="readwrite">
          <array length="fixed" length_constant="ED25519_KEY_LEN"/>
        </argument>
        <argument name="secret key" type="byte" access="readwrite">
          <array length="fixed" length_constant="ED25519_KEY_LEN"/>
        </argument>
      </method>

    </implementation>

    <implementation name="ed25519 private key">
      This is implementation of ED25519 private key
      <require library="ed25519" feature="ED25519 C"/>

      <context>
        <require header="ed25519/ed25519.h"/>
        <property name="secret_key" type="byte" access="readwrite">
          <array length="fixed" length_constant="ED25519_KEY_LEN"/>
        </property>
        <property name="signature" type="byte" access="readwrite">
          <array length="fixed" length_constant="ED25519_SIG_LEN"/>
        </property>
        <property name="message" class="buffer" type="byte" access="readwrite"/>
        <property name="message_len" type="size" access="readwrite"/>
      </context>

      <interface name="key"/>
      <interface name="generate key"/>
      <interface name="private key"/>
      <interface name="decrypt"/>
      <interface name="sign"/>
      <interface name="export private key"/>
      <interface name="import private key"/>

    </implementation>
</implementor>
