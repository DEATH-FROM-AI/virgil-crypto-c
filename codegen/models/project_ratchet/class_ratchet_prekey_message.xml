<class name="ratchet prekey message" context="public">

    <require impl="asn1wr" project="foundation" scope="private"/>
    <require impl="asn1rd" project="foundation" scope="private"/>

    <constant name="public key length" definition="public" value="32"/>

    <constant name="max message length" definition="public" value="1024 * 1024 * 1024">
        FIXME
    </constant>

    <property name="protocol version" type="size" size="1"/>
    <property name="identity key" class="buffer" access="readwrite"/>
    <property name="long term key" class="buffer" access="readwrite"/>
    <property name="one time key" class="buffer" access="readwrite"/>
    <property name="message" class="buffer" access="readwrite"/>

    <constructor name="with members">
        <argument name="protocol version" type="size" size="1"/>
        <argument name="identity key" class="buffer"/>
        <argument name="long term key" class="buffer"/>
        <argument name="one time key" class="buffer"/>
        <argument name="message" class="buffer"/>
    </constructor>

    <method name="serialize len" is_static="1">
        <argument name="message len" type="size"/>

        <return type="size"/>
    </method>

    <method name="serialize">
        <argument name="output" class="buffer"/>

        <return enum="error"/>
    </method>

    <method name="deserialize" is_static="1">
        <argument name="input" class="data"/>
        <argument name="err ctx" class="error ctx" access="readwrite"/>

        <return class="self" access="disown"/>
    </method>

</class>
