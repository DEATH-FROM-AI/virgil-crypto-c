<implementor name="mbedtls" is_default="1">
    Provide implementation based on the library ARM mbedTLS.


    <implementation name="hmac224">
        This is MbedTLS implementation of HMAC224.

        <require_include name="mbedtls/md.h" type="context"/>
        <require library="mbedtls" feature="MD C"/>
        <require library="mbedtls" feature="SHA256 C"/>

        <context>
            <property name="hmac ctx" class="mbedtls_md_context_t" access="readwrite" is_reference="0"/>
        </context>

        <interface name="hmac info">
            <constant name="digest size" value="28"/>
        </interface>

        <interface name="hmac"/>
        <interface name="hmac stream"/>
    </implementation>


    <implementation name="hmac256">
        This is MbedTLS implementation of HMAC256.

        <require_include name="mbedtls/md.h" type="context"/>
        <require library="mbedtls" feature="MD C"/>
        <require library="mbedtls" feature="SHA256 C"/>

        <context>
            <property name="hmac ctx" class="mbedtls_md_context_t" access="readwrite" is_reference="0"/>
        </context>

        <interface name="hmac info">
            <constant name="digest size" value="32"/>
        </interface>

        <interface name="hmac"/>
        <interface name="hmac stream"/>
    </implementation>


    <implementation name="hmac384">
        This is MbedTLS implementation of HMAC384.

        <require_include name="mbedtls/md.h" type="context"/>
        <require library="mbedtls" feature="MD C"/>
        <require library="mbedtls" feature="SHA512 C"/>

        <context>
            <property name="hmac ctx" class="mbedtls_md_context_t" access="readwrite" is_reference="0"/>
        </context>

        <interface name="hmac info">
            <constant name="digest size" value="48"/>
        </interface>

        <interface name="hmac"/>
        <interface name="hmac stream"/>
    </implementation>


    <implementation name="hmac512">
        This is MbedTLS implementation of HMAC512.

        <require_include name="mbedtls/md.h" type="context"/>
        <require library="mbedtls" feature="MD C"/>
        <require library="mbedtls" feature="SHA512 C"/>

        <context>
            <property name="hmac ctx" class="mbedtls_md_context_t" access="readwrite" is_reference="0"/>
        </context>

        <interface name="hmac info">
            <constant name="digest size" value="64"/>
        </interface>

        <interface name="hmac"/>
        <interface name="hmac stream"/>
    </implementation>


    <implementation name="sha224">
        This is MbedTLS implementation of SHA224.

        <require_include name="mbedtls/sha256.h" type="context"/>
        <require library="mbedtls" feature="SHA256 C"/>

        <context>
            <property name="hash ctx" class="mbedtls_sha256_context" access="readwrite" is_reference="0"/>
        </context>

        <interface name="hash info">
            <constant name="digest size" value="28"/>
        </interface>

        <interface name="hash"/>
        <interface name="hash stream"/>
    </implementation>


    <implementation name="sha256">
        This is MbedTLS implementation of SHA256.

        <require_include name="mbedtls/sha256.h" type="context"/>
        <require library="mbedtls" feature="SHA256 C"/>

        <context>
            <property name="hash ctx" class="mbedtls_sha256_context" access="readwrite" is_reference="0"/>
        </context>

        <interface name="hash info">
            <constant name="digest size" value="32"/>
        </interface>

        <interface name="hash"/>
        <interface name="hash stream"/>
    </implementation>


    <implementation name="sha384">
        This is MbedTLS implementation of SHA384.

        <require_include name="mbedtls/sha512.h" type="context"/>
        <require library="mbedtls" feature="SHA512 C"/>

        <context>
            <property name="hash ctx" class="mbedtls_sha512_context" access="readwrite" is_reference="0"/>
        </context>

        <interface name="hash info">
            <constant name="digest size" value="48"/>
        </interface>

        <interface name="hash"/>
        <interface name="hash stream"/>
    </implementation>


    <implementation name="sha512">
        This is MbedTLS implementation of SHA512.

        <require_include name="mbedtls/sha512.h" type="context"/>
        <require library="mbedtls" feature="SHA512 C"/>

        <context>
            <property name="hash ctx" class="mbedtls_sha512_context" access="readwrite" is_reference="0"/>
        </context>

        <interface name="hash info">
            <constant name="digest size" value="64"/>
        </interface>

        <interface name="hash"/>
        <interface name="hash stream"/>
    </implementation>


    <implementation name="aes256 gcm">
        Implementation of the symmetric cipher AES-256 bit in a GCM mode.
        Note, this implementation contains dynamic memory allocations,
        this should be improved in the future releases.

        <require_include name="mbedtls/cipher.h" type="context"/>
        <require library="mbedtls" feature="CIPHER C"/>

        <context name="aes256 gcm">
            <property name="cipher ctx" class="mbedtls_cipher_context_t" access="readwrite" is_reference="0"/>

            <property name="key" type="data" access="readwrite">
                <array length="fixed" length_constant=".(class_aes256_gcm_constant_key_len)"/>
            </property>

            <property name="nonce" type="data" access="readwrite">
                <array length="fixed" length_constant=".(class_aes256_gcm_constant_nonce_len)"/>
            </property>
        </context>

        <interface name="encrypt"/>

        <interface name="decrypt"/>

        <interface name="cipher info">
            <constant name="nonce len" value="12"/>
            <constant name="key len" value="32"/>
            <constant name="key bitlen" value="256"/>
            <constant name="block len" value="16"/>
        </interface>

        <interface name="cipher"/>

        <interface name="cipher auth info">
            <constant name="auth tag len" value="16"/>
        </interface>

        <interface name="auth encrypt"/>
        <interface name="auth decrypt"/>
        <interface name="cipher auth"/>
    </implementation>

    <!--
    <implementation name="asn1_wr">
        This is MbedTLS implementation of ASN.1 writer.

        <c_include file="mbedtls/asn1.h" is_system="1" scope="private"/>
        <c_include file="mbedtls/asn1write.h" is_system="1" scope="private"/>


        <interface name="asn1_writer"/>

    </implementation>

    <implementation name="asn1_rd">
        This is MbedTLS implementation of ASN.1 reader.

        <c_include file="mbedtls/asn1.h" is_system="1" scope="private"/>

        <interface name="asn1_reader"/>

    </implementation>
-->
</implementor>
