<implementor name="virgil" is_default="1">
    Provide implementation based on the Virgil Security implementations.

    <implementation name="hkdf">
        Virgil Security implementation of the HKDF (RFC 6234) algorithm.

        <interface name="ex_kdf"/>

        <dependency name="hmac" interface="hmac stream" type="impl"/>

        <constant name="hash counter max" value="255"/>

        <method name="extract" context="impl">
            Extracts fixed-length pseudorandom key from keying material.

            <argument name="data" type="data"/>
            <argument name="data len" type="size"/>
            <argument name="salt" type="data"/>
            <argument name="salt len" type="size"/>
            <argument name="pr key" type="data" access="writeonly"/>
            <argument name="pr key len" type="size"/>
        </method>

        <method name="expand" context="impl">
            Expands the pseudorandom key to the desired length.

            <argument name="pr key" type="data" access="readwrite"/>
            <argument name="pr key len" type="size"/>
            <argument name="info" type="data"/>
            <argument name="info len" type="size"/>
            <argument name="key" type="data" access="writeonly"/>
            <argument name="key len" type="size"/>
        </method>
    </implementation>


    <implementation name="kdf1">
        Virgil Security implementation of the KDF1 (ISO-18033-2) algorithm.

        <interface name="kdf"/>

        <dependency name="hash" interface="hash stream" type="impl"/>
    </implementation>


    <implementation name="kdf2">
        Virgil Security implementation of the KDF2 (ISO-18033-2) algorithm.

        <interface name="kdf"/>

        <dependency name="hash" interface="hash stream" type="impl"/>
    </implementation>


    <implementation name="fake random">
        Random number generator that is used for test purposes only.


        <interface name="random"/>


        <context>
            <property name="data source" class="data" access="readwrite"/>
            <property name="byte source" type="byte"/>
            <property name="pos" type="size"/>
        </context>


        <method name="setup source byte" declaration="public">
            Configure random number generator to generate sequence filled with given byte.

            <argument name="byte source" type="byte"/>
        </method>


        <method name="setup source data" declaration="public">
            Configure random number generator to generate random sequence from given data.
            Note, that given data is used as circular source.

            <argument name="data source" class="data"/>
        </method>
    </implementation>


<!--
    <implementation name="dynamic_list">
        Virgil Security implementation of dynamic list.

        <interface name="list" />

    </implementation>

    <implementation name="password_recipient">
        CMS Password recipient.

        <interface name="cms" />

    </implementation>

    <implementation name="key_trans_recipient">
        CMS Key Trans Recipient.

        <interface name="cms" />

    </implementation>

    <implementation name="enveloped_data">
        CMS Enveloped Data.

        <interface name="cms" />

    </implementation>

    <implementation name="encrypted_content">
        CMS EncryptedContent.

        <interface name="cms" />

    </implementation>

    <implementation name="content">
        CMS Content.

        <interface name="cms" />

    </implementation>

    <implementation name="content_info">
        CMS Content Info.

        <interface name="cms" />

    </implementation>
-->
</implementor>
